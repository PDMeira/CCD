/*
 * jQuery html5upload Plugin
 * @version 1.0.2
 * @requires jQuery-1.2 or later
 *
 * Copyright 2010, Caleb P Burns
 * Dual licensed under the MIT and GPL licenses:
 * 	http://www.opensource.org/licenses/mit-license.php
 * 	http://www.gnu.org/licenses/gpl.html
 */
(function(a){a.fn.html5upload=function(d){var d=a.extend({data:null,onAbort:null,onError:null,onLoad:null,onProgress:null,url:null,sendFormData:false},d);var f=typeof(d.url)==="string"&&d.url.length?d.url:null;var c=null;switch(this[0].tagName.toLowerCase()){case"form":c=a(this).find("input[type=file]");f=f||this[0].action;break;case"input":c=this;break;default:break}if(!c){return false}var h=window.XMLHttpRequest?new XMLHttpRequest():null;if(!h&&window.ActiveXObject){try{h=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{h=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}}if(!h){return false}h.open("POST",f||window.location.href);f=undefined;h.setRequestHeader("Cache-Control","no-cache");h.setRequestHeader("X-Requested-With","XMLHttpRequest");var n=this;n.xhr=h;if(d.onAbort&&typeof(d.onAbort)==="function"){h.onabort=d.onAbort;h.upload.onabort=d.onAbort}if(d.onError&&typeof(d.onError)==="function"){h.onerror=d.onError;h.upload.onerror=d.onError}if(d.onLoad&&typeof(d.onLoad)==="function"){h.onload=function(e){d.onLoad(e,n.xhr)}}if(d.onProgress&&typeof(d.onProgress)==="function"){h.upload.onprogress=d.onProgress}var p=new Array();var o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'()+_-./:=? ";while(p.length<69){p.push(o[Math.floor(Math.random()*(o.length+1))])}var l;while(p.length<70){if((l=o[Math.floor(Math.random()*(o.length+1))])!==" "){p.push(l)}}l=undefined;o=undefined;var s=p.join("");p.length=0;h.setRequestHeader("Content-Type","multipart/form-data, boundary="+s);p.push("--",s,"\r\n");if(d.sendFormData&&this[0].tagName.toLowerCase()==="form"){var w=a(this).serializeArray();var g=w.length;for(var r=0;r<g;r++){p.push('Content-Disposition: form-data; name="',w[r].name,'"\r\n\r\n');p.push(w[r].value,"\r\n");p.push("--",s,"\r\n")}w=undefined}if(d.data&&typeof(d.data)==="object"){for(var y in d.data){p.push('Content-Disposition: form-data; name="',y,'"\r\n\r\n');p.push(d.data[y],"\r\n");p.push("--",s,"\r\n")}}var k,u,r,q,x,v;var m=c.length;for(r=0;r<m;r++){k=c[r];x=k.name+(k.multiple?"[]":"");v=k.files.length;for(q=0;q<v;q++){u=k.files[q];p.push('Content-Disposition: form-data; name="',x,'"; filename="',u.name,'"\r\n');p.push("Content-Type: ",(u.type?u.type:"application/octet-stream"),"\r\n\r\n");p.push(u.getAsBinary(),"\r\n");p.push("--",s,"\r\n")}}k=u=x=undefined;p.push("--",s,"--\r\n");s=undefined;var b=p.join("");p.length=0;p=undefined;h.sendAsBinary(b);b=undefined;h=undefined;return true}})(jQuery);
